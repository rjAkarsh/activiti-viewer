<div class="mt-3">
    <div class="d-flex justify-content-between">
        <h6 class="text-success">Subprocesses</h6>
        <button class="btn btn-xs btn-link text-danger p-0" onclick="this.closest('.nested-container').innerHTML = ''">Hide</button>
    </div>
    
    {% for sub in subprocesses %}
    <!-- We reuse the same process card Logic recursively! -->
    <!-- NOTE: For full recursion, we would include the process_card fragment here. 
         For simplicity of this demo, we show a simplified card that allows loading the full view -->
    <div class="card border-success mb-2">
        <div class="card-body p-2 d-flex justify-content-between align-items-center">
            <div>
                <strong>{{ sub.processDefinitionKey }}</strong> <span class="badge bg-success">{{ sub.status }}</span>
            </div>
            <div class="btn-group">
                <button class="btn btn-sm btn-secondary" 
                        hx-get="/api/process-instance/search?processId={{ sub.id }}" 
                        hx-target="#main-display">
                    Load full view
                </button>
                <button class="btn btn-sm btn-primary" 
                        hx-get="/api/process-instance/search?processId={{ sub.id }}&nested=true" 
                        hx-target="closest .nested-container"
                        hx-swap="innerHTML">
                    Show below
                </button>
            </div>
        </div>
    </div>
    {% else %}
    <div class="text-muted fst-italic">No subprocesses found.</div>
    {% endfor %}
</div>